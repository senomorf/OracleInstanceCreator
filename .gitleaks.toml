# Gitleaks configuration for OracleInstanceCreator
title = "Gitleaks Configuration"

# Configure detection rules
[[rules]]
id = "generic-api-key"
description = "Generic API Key"
regex = '''(?i)(?:key|api|token|secret|password|pwd|auth)['"\s]*[:=]\s*['"]?[a-zA-Z0-9_\-]{20,}'''
entropy = 3.7
tags = ["key", "API"]

[[rules]]
id = "slack-token"
description = "Slack token"  
regex = '''xox[baprs]-([0-9a-zA-Z]{10,48})'''
tags = ["slack", "token"]

[[rules]]
id = "github-token"
description = "GitHub Personal Access Token"
regex = '''ghp_[0-9a-zA-Z]{36}'''
tags = ["github", "token"]

# Global allowlist
[allowlist]
description = "Global allowlist"
commits = []
paths = [
    "tests/.*",
    "docs/.*\\.md",
    "\\.github/workflows/.*\\.yml"
]
regexes = [
    # Allow example/placeholder values
    "example\\.com",
    "placeholder",
    "your-.*-here",
    "PLACEHOLDER_.*",
    # Allow common test patterns
    "test.*secret",
    "dummy.*token"
]